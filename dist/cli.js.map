{"version":3,"sources":["../src/cli.ts","../src/config.ts","../src/pipe.ts"],"sourcesContent":["#!/bin/bash\n\nimport { Command } from 'commander'\nimport { REPORT_DIR } from './config'\nimport { getPipeAsArray } from './pipe'\n\nconst { name, description, version } = require('../package.json')\n\nconst program = new Command()\n\nprogram\n  .name(name)\n  .description(description)\n  .version(version)\n\nprogram.command('update')\n  .description('Updates a report')\n  .argument('<name>', 'Identifier of the report to update')\n  .argument('[source]', 'CSV string of \"METHOD ENDPOINT\" strings, a URL.  This argument can be ignored when using Linux piping.')\n  .action((name, source) => {\n    console.log(name, source)\n  })\n/*\nprogram.command('split')\n  .description('')\n  .argument('<string>', 'string to split')\n  .option('--first', 'display just the first substring')\n  .option('-s, --separator <char>', 'separator character', ',')\n  .action((arg, { first, separator }) => {\n    const limit = first ? 1 : undefined;\n    console.log(arg.split(separator, limit));\n  })\n*/\nasync function main () {\n  await getPipeAsArray(async (chunk: string[]) => {\n    console.log(chunk)\n    console.log(REPORT_DIR)\n  })\n\n  program.parse()\n}\n\nmain()\n\n\n","require('dotenv').config()\nimport { resolve } from 'path'\n\nexport const HOSTNAME = (process.env.HOSTNAME as string) || '0.0.0.0'\n\nexport const PORT = parseInt(process.env.PORT as string) || 3000\n\nexport const REPORT_DIR = (process.env.REPORT_DIR as string) || resolve(__dirname, '../reports')\n","export async function getPipeAsArray (onChunk: (chunk: string[]) => Promise<void>) {\n  return new Promise(resolve => {\n    \n    const stdin = process.openStdin()\n\n    stdin.on('data', async function(chunk) {\n      const result: string[] = []\n\n      chunk\n        .toString()\n        .split('\\n')\n        .forEach(line => {\n          const output = line.trim()\n\n          if (output === '') {\n            return\n          } else {\n            result.push(line)\n          }\n        })\n      \n      await onChunk(result)\n    })\n    \n    stdin.on('end', function () {\n      resolve(true)\n    })\n  })\n}\n"],"mappings":";u/CAEA,MAAwB,qBCDxB,MAAwB,gBADxB,QAAQ,UAAU,OAAO,EAGlB,GAAM,GAAY,QAAQ,IAAI,UAAuB,UAE/C,EAAO,SAAS,QAAQ,IAAI,IAAc,GAAK,IAE/C,EAAc,QAAQ,IAAI,YAAyB,cAAQ,UAAW,YAAY,ECP/F,iBAAsC,EAA6C,CACjF,MAAO,IAAI,SAAQ,GAAW,CAE5B,GAAM,GAAQ,QAAQ,UAAU,EAEhC,EAAM,GAAG,OAAQ,eAAe,EAAO,CACrC,GAAM,GAAmB,CAAC,EAE1B,EACG,SAAS,EACT,MAAM;AAAA,CAAI,EACV,QAAQ,GAAQ,CAGf,AAAI,AAFW,EAAK,KAAK,IAEV,IAGb,EAAO,KAAK,CAAI,CAEpB,CAAC,EAEH,KAAM,GAAQ,CAAM,CACtB,CAAC,EAED,EAAM,GAAG,MAAO,UAAY,CAC1B,EAAQ,EAAI,CACd,CAAC,CACH,CAAC,CACH,CFtBA,GAAM,CAAE,OAAM,cAAa,WAAY,IAEjC,EAAU,GAAI,WAEpB,EACG,KAAK,CAAI,EACT,YAAY,CAAW,EACvB,QAAQ,CAAO,EAElB,EAAQ,QAAQ,QAAQ,EACrB,YAAY,kBAAkB,EAC9B,SAAS,SAAU,oCAAoC,EACvD,SAAS,WAAY,wGAAwG,EAC7H,OAAO,CAAC,EAAM,IAAW,CACxB,QAAQ,IAAI,EAAM,CAAM,CAC1B,CAAC,EAYH,kBAAuB,CACrB,KAAM,GAAe,KAAO,IAAoB,CAC9C,QAAQ,IAAI,CAAK,EACjB,QAAQ,IAAI,CAAU,CACxB,CAAC,EAED,EAAQ,MAAM,CAChB,CAEA,EAAK","names":[]}